{% extends "nav.html" %}
{% block title %}
View File
{% endblock %}

{% block extraHead %}
<link href="https://mbraak.github.io/jqTree/jqtree.css" rel="stylesheet">
<link rel="stylesheet" href="https://rawgit.com/enyo/dropzone/master/dist/dropzone.css">
{% endblock %}

{% block body %}
<div class="container">
    <div class="header">
        <h3 class="text-muted">How To Upload a File</h3>
    </div>
    <hr/>
    <div>
        <div id="fileList"></div>
        Parent Directory Id: <input type="number" name="gallery_dir_id" readonly/><br />
        <div id="galleryUpload" class="dropzone">
        </div>
    </div>
</div>
{% endblock %}

{% block extraFooter %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqtree/1.3.5/tree.jquery.min.js"></script>
<script src="https://rawgit.com/enyo/dropzone/master/dist/dropzone.js"></script>
<script>
Dropzone.autoDiscover = false;

    $(function() {
        populateDirTree();

        var myDropzone = new Dropzone('div#galleryUpload', {
            url: '/upload',
            paramName: "gallery-upload",
            uploadMultiple: false,
            autoProcessQueue: true,
            parallelUploads: 3,
            accept: function(file, done) {
                done();
            },
            sending: function(file, xhr, formData) {
                formData.append('parent_id',
                    $('input[name="gallery_dir_id"]').val());
            },
            complete: function(file) {
                this.removeFile(file);
            },
            success: afterUpload
        });
    });
</script>
{% endblock %}
